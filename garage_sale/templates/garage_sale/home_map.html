{% extends "garage_sale/base.html" %}
{% load static %}

{% block title %}Garage Sale{% endblock %}

{% block head_extra %}
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
  <style>
    #map-wrap { height: calc(100vh - 56px); }
    #map { width: 100%; height: 100%; }
    .muted { color:#666; font-size: 12px; }
  </style>
{% endblock %}

{% block content %}
  <div id="map-wrap" class="d-flex">
    <div id="map" class="flex-grow-1"></div>
  </div>

  <script>
    window.GARAGE_SALE = {
      mapDataUrl: "{% url 'garage_sale:map_data' %}",
      defaultMap: {
        center: {{ default_map_center|default:"[-37.8136, 144.9631]"|safe }},
        zoom: {{ default_map_zoom|default:"10" }}
      },
      urls: {
        eventsList: "{% url 'garage_sale:events_list' %}",
        login: "{% url 'core:login' %}?next={% url 'garage_sale:home' %}",
        register: "{% url 'core:register' %}?next={% url 'garage_sale:home' %}"
      },
      isLoggedIn: {{ request.user.is_authenticated|yesno:"true,false" }},
      userRole: "{{ request.user.role|default:'' }}"
    };
  </script>
{% endblock %}

{% block scripts %}
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
  <script src="{% static 'garage_sale/js/home_map.js' %}"></script>
{% endblock %}
